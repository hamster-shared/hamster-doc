"use strict";(self.webpackChunkhamster_docs=self.webpackChunkhamster_docs||[]).push([[874],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var a=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(t),m=o,h=u["".concat(s,".").concat(m)]||u[m]||d[m]||r;return t?a.createElement(h,i(i({ref:n},p),{},{components:t})):a.createElement(h,i({ref:n},p))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,i=new Array(r);i[0]=u;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var c=2;c<r;c++)i[c]=t[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},5070:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>k,contentTitle:()=>b,default:()=>N,frontMatter:()=>v,metadata:()=>w,toc:()=>y});var a=t(7462),o=t(7294),r=t(3905),i=t(6010),l=t(2389),s=t(7392),c=t(7094),p=t(2466);const d="tabList__CuJ",u="tabItem_LNqP";function m(e){var n,t;const{lazy:r,block:l,defaultValue:m,values:h,groupId:g,className:f}=e,v=o.Children.map(e.children,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),b=null!=h?h:v.map((e=>{let{props:{value:n,label:t,attributes:a}}=e;return{value:n,label:t,attributes:a}})),w=(0,s.l)(b,((e,n)=>e.value===n.value));if(w.length>0)throw new Error('Docusaurus error: Duplicate values "'+w.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.');const k=null===m?m:null!=(n=null!=m?m:null==(t=v.find((e=>e.props.default)))?void 0:t.props.value)?n:v[0].props.value;if(null!==k&&!b.some((e=>e.value===k)))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+k+'" but none of its children has the corresponding value. Available values are: '+b.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");const{tabGroupChoices:y,setTabGroupChoices:x}=(0,c.U)(),[N,T]=(0,o.useState)(k),A=[],{blockElementScrollPositionUntilNextRender:O}=(0,p.o5)();if(null!=g){const e=y[g];null!=e&&e!==N&&b.some((n=>n.value===e))&&T(e)}const E=e=>{const n=e.currentTarget,t=A.indexOf(n),a=b[t].value;a!==N&&(O(n),T(a),null!=g&&x(g,String(a)))},C=e=>{var n;let t=null;switch(e.key){case"Enter":E(e);break;case"ArrowRight":{var a;const n=A.indexOf(e.currentTarget)+1;t=null!=(a=A[n])?a:A[0];break}case"ArrowLeft":{var o;const n=A.indexOf(e.currentTarget)-1;t=null!=(o=A[n])?o:A[A.length-1];break}}null==(n=t)||n.focus()};return o.createElement("div",{className:(0,i.Z)("tabs-container",d)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":l},f)},b.map((e=>{let{value:n,label:t,attributes:r}=e;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:N===n?0:-1,"aria-selected":N===n,key:n,ref:e=>A.push(e),onKeyDown:C,onClick:E},r,{className:(0,i.Z)("tabs__item",u,null==r?void 0:r.className,{"tabs__item--active":N===n})}),null!=t?t:n)}))),r?(0,o.cloneElement)(v.filter((e=>e.props.value===N))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},v.map(((e,n)=>(0,o.cloneElement)(e,{key:n,hidden:e.props.value!==N})))))}function h(e){const n=(0,l.Z)();return o.createElement(m,(0,a.Z)({key:String(n)},e))}const g="tabItem_Ymn6";function f(e){let{children:n,hidden:t,className:a}=e;return o.createElement("div",{role:"tabpanel",className:(0,i.Z)(g,a),hidden:t},n)}const v={sidebar_position:1},b="Overview",w={unversionedId:"AlineCI/overview",id:"AlineCI/overview",title:"Overview",description:"You can learn how to use ALine CI in this document.",source:"@site/docs/AlineCI/overview.md",sourceDirName:"AlineCI",slug:"/AlineCI/overview",permalink:"/docs/AlineCI/overview",draft:!1,editUrl:"https://github.com/hamster-shared/gitbook/blob/main/docs/AlineCI/overview.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"defaultSidebar",previous:{title:"ALine CI",permalink:"/docs/category/aline-ci"},next:{title:"Pipeline Syntax",permalink:"/docs/AlineCI/syntax"}},k={},y=[{value:"Install and Deploy ALine CI",id:"install-and-deploy-aline-ci",level:2},{value:"Pipeline File",id:"pipeline-file",level:2},{value:"Execute",id:"execute",level:2}],x={toc:y};function N(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,a.Z)({},x,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"overview"},"Overview"),(0,r.kt)("p",null,"You can learn how to use ALine CI in this document."),(0,r.kt)("h2",{id:"install-and-deploy-aline-ci"},"Install and Deploy ALine CI"),(0,r.kt)("p",null,"Aline is the core execution engine of hamster. It has a separate command line entry and can execute the hamster pipeline file in the local environment."),(0,r.kt)(h,{mdxType:"Tabs"},(0,r.kt)(f,{value:"linux",label:"linux",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"wget https://github.com/hamster-shared/a-line/releases/download/v0.2.0/aline-linux-amd64.tar.gz\ntar -czvf aline-darwin-amd64.tar.gz\nchmod +x aline\nsudo mv aline /usr/local/bin/\n"))),(0,r.kt)(f,{value:"macos",label:"macos",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"wget https://github.com/hamster-shared/a-line/releases/download/v0.2.0/aline-darwin-amd64.tar.gz\ntar -czvf aline-darwin-amd64.tar.gz\nchmod +x aline\nsudo mv aline /usr/local/bin/\n"))),(0,r.kt)(f,{value:"windows",label:"windows",mdxType:"TabItem"},(0,r.kt)("p",null,"Download ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/hamster-shared/a-line/releases/download/v0.2.0/aline-windows-amd64.tar.gz"},"aline-darwin-amd64.tar.gz"),"\nand decompress ",(0,r.kt)("inlineCode",{parentName:"p"},"aline-darwin-amd64.tar.gz"),". Then launch  ",(0,r.kt)("inlineCode",{parentName:"p"},"aline.exe"))),(0,r.kt)(f,{value:"source",label:"build from source",mdxType:"TabItem"},(0,r.kt)("p",null,"Before you build ,you should install ",(0,r.kt)("a",{parentName:"p",href:"https://tip.golang.org/doc/install"},"golang 1.19")," and ",(0,r.kt)("a",{parentName:"p",href:"https://nodejs.org/en/download/"},"node v16"),", you can get information from ",(0,r.kt)("a",{parentName:"p",href:"https://tip.golang.org/doc/install"},"this document"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"git clone -b v0.2.0 https://github.com/hamster-shared/a-line.git\ncd a-line\nmake build\nsudo mv aline /usr/local/bin/\n")))),(0,r.kt)("h2",{id:"pipeline-file"},"Pipeline File"),(0,r.kt)("p",null,"Pipeline file is a yaml file that defines how to pull, compile, and build code. We will provide a simple example to show you the basic format of ALine CI pipeline."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="example.yml"',title:'"example.yml"'},"version: 1.0\nname: example\nstages:\n  git-clone:\n    steps:\n      - name: git-clone\n        uses: git-checkout\n        with:\n          url: https://github.com/mohaijiang/truffle-MetaCoin.git\n          branch: main\n          \n  code-compile:\n    needs:\n      - git-clone\n    steps:\n      - name: code-compile\n        uses: shell\n        run: |\n          npm install -g truffle\n          truffle compile\n\n")),(0,r.kt)("h2",{id:"execute"},"Execute"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"ubuntu@ubuntu:/tmp$ /usr/local/bin/aline --file example.yml \n2023/01/13 06:53:09 job detail file not exist stat /home/ubuntu/pipelines/jobs/example/job-details: no such file or directory\n2023-01-13 06:53:09 [INFO] [executor.go:138] stage: {\n2023-01-13 06:53:09 [INFO] [executor.go:139]    // git-clone\n2023-01-13 06:53:09 [INFO] [action_git.go:66] git stack: map[env:[NAME=example] hamsterRoot:/home/ubuntu/workdir id:0 name:example parameter:map[] workdir:/home/ubuntu/workdir/example]\n2023-01-13 06:53:09 [DEBU] [action_git.go:168] execute git clone command: git rev-parse --is-inside-work-tree\nfatal: not a git repository (or any of the parent directories): .git\n2023-01-13 06:53:09 [ERRO] [action_git.go:227] shell command wait error: exit status 128\n2023-01-13 06:53:09 [DEBU] [action_git.go:168] execute git clone command: git init\nhint: Using 'master' as the name for the initial branch. This default branch name\nhint: is subject to change. To configure the initial branch name to use in all\nhint: of your new repositories, which will suppress this warning, call:\nhint: \nhint:   git config --global init.defaultBranch <name>\nhint: \nhint: Names commonly chosen instead of 'master' are 'main', 'trunk' and\nhint: 'development'. The just-created branch can be renamed via this command:\nhint: \nhint:   git branch -m <name>\nInitialized empty Git repository in /home/ubuntu/workdir/example/.git/\n2023-01-13 06:53:09 [DEBU] [action_git.go:168] execute git clone command: git config remote.origin.url https://github.com/mohaijiang/truffle-MetaCoin.git\n2023-01-13 06:53:09 [DEBU] [action_git.go:168] execute git clone command: git config --add remote.origin.fetch +refs/heads/*:refs/remotes/origin/*\n2023-01-13 06:53:09 [DEBU] [action_git.go:168] execute git clone command: git config remote.origin.url https://github.com/mohaijiang/truffle-MetaCoin.git\n2023-01-13 06:53:09 [DEBU] [action_git.go:168] execute git clone command: git fetch --tags --progress https://github.com/mohaijiang/truffle-MetaCoin.git +refs/heads/*:refs/remotes/origin/*\nremote: Enumerating objects: 28, done.        \nremote: Counting objects: 100% (28/28), done.        \nremote: Compressing objects: 100% (19/19), done.        \nremote: Total 28 (delta 6), reused 27 (delta 5), pack-reused 0        \nFrom https://github.com/mohaijiang/truffle-MetaCoin\n * [new branch]      main       -> origin/main\n2023-01-13 06:53:09 [DEBU] [action_git.go:244] execute git clone command: git rev-parse refs/remotes/origin/main^{commit}\n2023-01-13 06:53:09 [DEBU] [action_git.go:168] execute git clone command: git config core.sparsecheckout\n2023-01-13 06:53:09 [ERRO] [action_git.go:227] shell command wait error: exit status 1\n2023-01-13 06:53:09 [DEBU] [action_git.go:168] execute git clone command: git checkout -f 1343ff6d436d6b29cfe8d62a2a8345f29b891177\nNote: switching to '1343ff6d436d6b29cfe8d62a2a8345f29b891177'.\n\nYou are in 'detached HEAD' state. You can look around, make experimental\nchanges and commit them, and you can discard any commits you make in this\nstate without impacting any branches by switching back to a branch.\n\nIf you want to create a new branch to retain commits you create, you may\ndo so (now or later) by using -c with the switch command. Example:\n\n  git switch -c <new-branch-name>\n\nOr undo this operation with:\n\n  git switch -\n\nTurn off this advice by setting config variable advice.detachedHead to false\n\nHEAD is now at 1343ff6 init\n2023-01-13 06:53:09 [DEBU] [action_git.go:244] execute git clone command: git branch -a -v --no-abbrev\n2023-01-13 06:53:09 [DEBU] [action_git.go:168] execute git clone command: git checkout -b main 1343ff6d436d6b29cfe8d62a2a8345f29b891177\nSwitched to a new branch 'main'\n2023-01-13 06:53:09 [INFO] [executor.go:210] }\n2023-01-13 06:53:09 [INFO] [executor.go:138] stage: {\n2023-01-13 06:53:09 [INFO] [executor.go:139]    // code-compile\n2023-01-13 06:53:09 [INFO] [action_shell.go:73] shell stack: map[env:[NAME=example] hamsterRoot:/home/ubuntu/workdir id:0 name:example parameter:map[] workdir:/home/ubuntu/workdir/example]\n2023-01-13 06:53:09 [DEBU] [action_shell.go:90] execute shell command: sh -c /home/ubuntu/workdir/example_tmp/XVlBzgbaiC.sh\n+ npm install -g truffle\nnpm WARN deprecated mkdirp-promise@5.0.1: This package is broken and no longer maintained. 'mkdirp' itself supports promises now, please switch to that.\nnpm WARN deprecated har-validator@5.1.5: this library is no longer supported\nnpm WARN deprecated apollo-datasource@3.3.2: The `apollo-datasource` package is part of Apollo Server v2 and v3, which are now deprecated (end-of-life October 22nd 2023). See https://www.apollographql.com/docs/apollo-server/previous-versions/ for more details.\nnpm WARN deprecated apollo-server-plugin-base@3.7.1: The `apollo-server-plugin-base` package is part of Apollo Server v2 and v3, which are now deprecated (end-of-life October 22nd 2023). This package's functionality is now found in the `@apollo/server` package. See https://www.apollographql.com/docs/apollo-server/previous-versions/ for more details.\nnpm WARN deprecated apollo-server-types@3.7.1: The `apollo-server-types` package is part of Apollo Server v2 and v3, which are now deprecated (end-of-life October 22nd 2023). This package's functionality is now found in the `@apollo/server` package. See https://www.apollographql.com/docs/apollo-server/previous-versions/ for more details.\nnpm WARN deprecated apollo-server-errors@3.3.1: The `apollo-server-errors` package is part of Apollo Server v2 and v3, which are now deprecated (end-of-life October 22nd 2023). This package's functionality is now found in the `@apollo/server` package. See https://www.apollographql.com/docs/apollo-server/previous-versions/ for more details.\nnpm WARN deprecated apollo-server@3.11.1: The `apollo-server` package is part of Apollo Server v2 and v3, which are now deprecated (end-of-life October 22nd 2023). This package's functionality is now found in the `@apollo/server` package. See https://www.apollographql.com/docs/apollo-server/previous-versions/ for more details.\nnpm WARN deprecated apollo-server-express@3.11.1: The `apollo-server-express` package is part of Apollo Server v2 and v3, which are now deprecated (end-of-life October 22nd 2023). This package's functionality is now found in the `@apollo/server` package. See https://www.apollographql.com/docs/apollo-server/previous-versions/ for more details.\nnpm WARN deprecated uuid@2.0.1: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\nnpm WARN deprecated multicodec@1.0.4: This module has been superseded by the multiformats module\nnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\nnpm WARN deprecated apollo-server-env@4.2.1: The `apollo-server-env` package is part of Apollo Server v2 and v3, which are now deprecated (end-of-life October 22nd 2023). This package's functionality is now found in the `@apollo/utils.fetcher` package. See https://www.apollographql.com/docs/apollo-server/previous-versions/ for more details.\nnpm WARN deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142\nnpm WARN deprecated multibase@0.6.1: This module has been superseded by the multiformats module\nnpm WARN deprecated multibase@0.7.0: This module has been superseded by the multiformats module\nnpm WARN deprecated apollo-reporting-protobuf@3.3.3: The `apollo-reporting-protobuf` package is part of Apollo Server v2 and v3, which are now deprecated (end-of-life October 22nd 2023). This package's functionality is now found in the `@apollo/usage-reporting-protobuf` package. See https://www.apollographql.com/docs/apollo-server/previous-versions/ for more details.\nnpm WARN deprecated multicodec@0.5.7: This module has been superseded by the multiformats module\nnpm WARN deprecated cids@0.7.5: This module has been superseded by the multiformats module\nnpm WARN deprecated apollo-server-core@3.11.1: The `apollo-server-core` package is part of Apollo Server v2 and v3, which are now deprecated (end-of-life October 22nd 2023). This package's functionality is now found in the `@apollo/server` package. See https://www.apollographql.com/docs/apollo-server/previous-versions/ for more details.\n\nchanged 759 packages, and audited 788 packages in 40s\n\n89 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\n+ truffle compile\n\nCompiling your contracts...\n===========================\n- Fetching solc version list from solc-bin. Attempt #1\n- Fetching solc version list from solc-bin. Attempt #1\n- Downloading compiler. Attempt #1.\n- Fetching solc version list from solc-bin. Attempt #1\n- Downloading compiler. Attempt #1.\n> Compiling ./contracts/ConvertLib.sol\n> Compiling ./contracts/MetaCoin.sol\n> Artifacts written to /home/ubuntu/workdir/example/build/contracts\n> Compiled successfully using:\n   - solc: 0.8.13+commit.abaa5c0e.Emscripten.clang\n2023-01-13 06:54:07 [INFO] [action_shell.go:153] execute shell command success\n2023-01-13 06:54:07 [INFO] [executor.go:210] }\n2023-01-13 06:54:07 [TRAC] [output.go:118] output done, flush all, close file\n")))}N.isMDXComponent=!0}}]);